System.register("chunks:///_virtual/Card.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(e){"use strict";var t,a,i,n,r,o,s,c,p,l,u,h,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,s=e.SpriteFrame,c=e.find,p=e.Sprite,l=e.tween,u=e.v3,h=e.Component},function(e){d=e.GameManager}],execute:function(){var f,C,g,m,S,E,b,D,v;r._RF.push({},"25258bvT1hPcbXwT6/eAEY9","Card",void 0);var y=o.ccclass,M=o.property,_=e("CardState",{NONE:0,SELECTED:1,DISABLED:2});e("Card",(f=y("Card"),C=M(d),g=M(s),m=M(s),f((b=t((E=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"gameManager",b,n(t)),i(t,"faceUpSprite",D,n(t)),i(t,"faceDownSprite",v,n(t)),t.bonus=1,t._stateCard=void 0,t.isOpen=!1,t.isMatched=!1,t}a(t,e);var r=t.prototype;return r.onLoad=function(){this.gameManager=c("Canvas").getComponent(d),this._stateCard=_.NONE},r.setDisable=function(){this._stateCard=_.DISABLED},r.onClickFlipCard=function(){this.isMatched||this.gameManager.isOnFlipping||(this._stateCard===_.SELECTED?this.CloseCard():this.OpenCard(),this.gameManager.CardSelected(this))},r.OpenCard=function(){var e=this,t=this.node.getComponent(p);l(this.node).to(.15,{scale:u(0,1,1)}).call((function(){t.spriteFrame=e.faceUpSprite})).to(.15,{scale:u(1,1,1)}).start(),this.isOpen=!0,this._stateCard=_.SELECTED},r.CloseCard=function(){var e=this,t=this.node.getComponent(p);l(this.node).to(.15,{scale:u(0,1,1)}).call((function(){t.spriteFrame=e.faceDownSprite})).to(.15,{scale:u(1,1,1)}).start(),this.isOpen=!1,this.isMatched=!1,this._stateCard=_.NONE},r.compareTo=function(e){return e.faceUpSprite===this.faceUpSprite&&this!==e},r.getBonus=function(){return"Godot"===this.faceUpSprite.name?5:1},t}(h)).prototype,"gameManager",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(E.prototype,"faceUpSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(E.prototype,"faceDownSprite",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=E))||S));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts","./Util.ts","./index.mjs_cjs=&original=.js","./index.js"],(function(t){"use strict";var e,n,i,r,o,s,a,c,u,l,d,h,m,f,p,g,C,b,y,v,k,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){a=t.cclegacy,c=t._decorator,u=t.Label,l=t.Node,d=t.CCInteger,h=t.Prefab,m=t.SpriteAtlas,f=t.instantiate,p=t.Layout,g=t.UITransform,C=t.Size,b=t.Component,y=t.game},function(t){v=t.Card},function(t){k=t.shuffle},null,function(t){S=t.default}],execute:function(){var I,w,T,z,O,_,L,M,N,F,G,x,A,P,j,U,B,D,E,R,J;a._RF.push({},"e2b42proKFOB4OS9tkIU8es","GameManager",void 0);var H=c.ccclass,K=c.property,W=S,X=W.enc.Utf8.parse(16),Y="https://socket.play4promote.com/api",q=(t("GameManager",(I=H("GameManager"),w=K(u),T=K(l),z=K(d),O=K(d),_=K(h),L=K(m),M=K(u),N=K(l),F=K(l),I((A=e((x=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,i(e,"timerText",A,r(e)),i(e,"blockIO",P,r(e)),i(e,"rows",j,r(e)),i(e,"columns",U,r(e)),i(e,"cellPrefab",B,r(e)),i(e,"logos",D,r(e)),i(e,"scoreLabel",E,r(e)),i(e,"frameNode",R,r(e)),i(e,"startScreen",J,r(e)),e._timeLeft=void 0,e._isActiveTime=!1,e.matchesFounded=0,e.isOnFlipping=!1,e.firstCard=null,e.secondCard=null,e.token=null,e.tournamentId=null,e.skinId=null,e.key=null,e}n(e,t);var a=e.prototype;return a.onLoad=function(){var t=o(s().mark((function t(){var e,n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new URLSearchParams(window.location.search),this.token=e.get("token"),this.skinId=e.get("skinId"),this.tournamentId=e.get("tournamentId"),t.next=6,fetch(Y+"/games/authenticate-tournament?token="+this.token+"&tournamentId="+this.tournamentId+"&skinId="+this.skinId).then((function(t){return t.json()})).then((function(t){1==t.ResultCode?n.key=t.Data.Key:(console.log("Out of tickets"),y.pause())})).catch((function(t){return console.log("Fetch failed")}));case 6:this.initGrid(),this.SetupGame();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.matchEvent=function(){var t=this;this.scoreLabel.string=this.matchesFounded.toString(),this.isCompletedGame()&&this.scheduleOnce((function(){t.gameCompleted()}),2)},a.gameCompleted=function(){var t=new q(100069,this.tournamentId,this.skinId).encrypt(this.key);fetch(Y+"/games/store-score-tournament?tournamentId="+this.tournamentId+"&skinId="+this.skinId+"&cocos=1",{headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":this.token},method:"POST",body:JSON.stringify({data:t})}),window.parent.postMessage(JSON.stringify({error:!1,message:"Hello World",score:this.matchesFounded,type:"game_tournament"}),"*")},a.screenCapture=function(){},a.startTimer=function(t){this.node.active=!0,this._timeLeft=t,this._isActiveTime=!0},a.startGame=function(){this.startScreen.active=!1,this.startTimer(30)},a.initGrid=function(){this.frameNode.removeAllChildren();for(var t=0;t<this.columns*this.rows;t++){f(this.cellPrefab).parent=this.frameNode}this.SetupCellSize()},a.SetupCellSize=function(){var t=this.frameNode.getComponent(p),e=t.paddingTop,n=t.paddingBottom,i=t.paddingLeft,r=t.paddingRight,o=this.frameNode.getComponent(g).contentSize.width,s=this.frameNode.getComponent(g).contentSize.height,a=Math.round((o-i-r-(this.rows-1)*t.spacingX)/this.rows),c=Math.round((s-e-n-(this.columns-1)*t.spacingY)/this.columns);this.frameNode.getComponent(p).cellSize=new C(a,c)},a.SetupGame=function(){var t=this.logos.getSpriteFrames().slice(0,Math.round(this.rows*this.columns/2)),e=t.length,n=[];this.frameNode.children.forEach((function(i,r){n.push(t[r%e])})),n=k(n),this.frameNode.children.forEach((function(t,e){t.getComponent(v).faceUpSprite=n[e]})),this.startCountDown()},a.startCountDown=function(){this.timerText.node.active=!0,this._timeLeft=30,this._isActiveTime=!0},a.CardSelected=function(t){null==this.firstCard?(this.firstCard=t,this.firstCard.OpenCard()):null==this.secondCard&&(this.secondCard=t,this.secondCard.OpenCard(),this.isOnFlipping=!0,this.scheduleOnce(this.checkMatch,.8))},a.checkMatch=function(){this.firstCard.compareTo(this.secondCard)?(this.firstCard.isMatched=!0,this.secondCard.isMatched=!0,this.matchesFounded+=this.firstCard.getBonus(),this.matchEvent()):(this.firstCard.CloseCard(),this.secondCard.CloseCard()),this.firstCard=null,this.secondCard=null,this.isOnFlipping=!1},a.isCompletedGame=function(){return[].concat(this.frameNode.children).map((function(t){return t.getComponent(v)})).every((function(t){return t.isOpen&&t.isMatched}))},a.update=function(t){this._isActiveTime&&(this._timeLeft-=t,this.timerText.string="Time left "+Math.floor(this._timeLeft),this._timeLeft<=0&&(this._isActiveTime=!1,this.timerText.node.active=!1,this.gameCompleted()))},e}(b)).prototype,"timerText",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(x.prototype,"blockIO",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(x.prototype,"rows",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=e(x.prototype,"columns",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),B=e(x.prototype,"cellPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(x.prototype,"logos",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(x.prototype,"scoreLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(x.prototype,"frameNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(x.prototype,"startScreen",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=x))||G)),t("default",function(){function t(t,e,n){this.score=void 0,this.tournamentId=void 0,this.skinId=void 0,this.score=t,this.tournamentId=e,this.skinId=n}var e=t.prototype;return e.encrypt=function(t){return W.AES.encrypt(JSON.stringify({Score:this.score,TournamentId:this.tournamentId,SkinId:this.skinId}),t,{iv:X,mode:W.mode.CBC,padding:W.pad.Pkcs7}).toString()},e.decrypt=function(t,e){return W.AES.decrypt(t,e,{iv:X,mode:W.mode.CBC,padding:W.pad.Pkcs7}).toString(W.enc.Utf8)},t}()));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Card.ts","./GameManager.ts","./TimeManager.ts","./Util.ts"],(function(){"use strict";return{setters:[null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/TimeManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(e){"use strict";var t,i,r,n,a,o,s,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Label,c=e.Component},function(e){u=e.GameManager}],execute:function(){var l,m,f,h,p,g,v;a._RF.push({},"7b76asYxdZGBrDLPIY+QQcs","TimeManager",void 0);var d=o.ccclass,T=o.property;e("TimeManager",(l=d("TimeManager"),m=T(s),f=T(u),l((g=t((p=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"timerText",g,n(t)),r(t,"mainGame",v,n(t)),t._timeLeft=void 0,t._isActive=!1,t}i(t,e);var a=t.prototype;return a.startScreen=function(e){this.node.active=!0,this._timeLeft=e,this._isActive=!0},a.onTimerReachedZero=function(){this._isActive=!1,this.node.active=!1,this.mainGame.gameCompleted()},a.update=function(e){this._isActive&&(this._timeLeft-=e,this.setTimer(this._timeLeft),this._timeLeft<=0&&this.onTimerReachedZero())},a.setTimer=function(e){this.timerText.string="Time left "+Math.floor(e)},t}(c)).prototype,"timerText",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(p.prototype,"mainGame",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=p))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/Util.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("shuffle",(function(t){var e,n=t.length;for(;0!=n;){e=Math.floor(Math.random()*n),n--;var r=[t[e],t[n]];t[n]=r[0],t[e]=r[1]}return t})),e._RF.push({},"339c6S5IxNBi75GenHb2niX","Util",void 0),e._RF.pop()}}}));
